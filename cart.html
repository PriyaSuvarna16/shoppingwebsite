
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shopping Cart with Coupon</title>
<style>
/* ---------------- NAVBAR ---------------- */
* {
  margin: 0px;
  padding: 0px;
  box-sizing: border-box;
  font-family: Whitney, Arial, Helvetica, sans-serif;
}
#navbar {
  width: 100%;
  height: 80px;
  display: grid;
  grid-template-columns: 20% 30% 20%;
  background-color: white;
  box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;
  justify-content: space-between;
  position: sticky;
  top: 0px;
}
#left img {
  width: 50px;
}
#left {
  height: 80px;
  display: flex;
  align-items: center;
  justify-content: center;
}
#left > div {
  display: flex;
  align-items: center;
}
#right {
  height: 80px;
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  justify-content: center;
}
#right > div:nth-child(1) {
  display: flex;
  justify-content: right;
  align-items: center;
  margin-right: 5px;
}
#right > div:nth-child(1) > img {
  width: 20%;
  height: 40%;
}
#secure {
  display: flex;
  font-size: 20px;
  justify-content: left;
  align-items: center;
  color: gray;
}
#centre {
  display: flex;
  align-items: center;
  color: gray;
  justify-content: center;
  font-size: 14px;
}
#centre > span > span {
  text-decoration: underline;
  color: #49cabb;
}
span > a {
  color: gray;
  font-size: 14px;
}

/* ---------------- CART SECTION ---------------- */
#cartdiv {
  width: 100%;
  margin: auto;
  display: grid;
  grid-template-columns: 60% 20%;
  margin-top: 50px;
  align-items: flex-start;
  justify-content: center;
  gap: 40px;
}
#product {
  padding: 20px;
  gap: 20px;
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  text-align: center;
  border: 1px solid #ccc;
}
#product > div > div {
  display: flex;
  padding: 5px;
  margin: 5px;
  border-radius: 10px;
  background-color: white;
}
#product > div > div:hover {
  transform: scale(1.04);
  transition: all 0.3s ease;
}
#cartdiv img {
  border-radius: 10px;
  width: 25%;
  height: 50%;
}
#dile button {
  padding: 0px 10px 5px 10px;
  font-size: 20px;
  border: 1px solid #ccc;
  background-color: transparent;
  color: black;
  border: 0px;
}
#dele {
  border: 0px;
  background-color: transparent;
  display: block;
  padding: 0px;
  font-size: 10px;
  color: #ff3f6c;
}
#totalcart {
  padding: 30px;
  border-radius: 20px;
  position: fixed;
  top: 130px;
  right: 50px;
  border: 1px solid #ccc;
  background-color: white;
  width: 300px;
  box-shadow: rgba(149, 157, 165, 0.2) 0px 8px 24px;
}
#totalcart h2 {
  font-size: 20px;
  color: #333;
  text-align: center;
}
#totalcart button {
  width: 100%;
  border: 0px;
  padding: 8px 5px;
  background-color: #ff3f6c;
  margin-top: 15px;
  color: white;
  font-size: 16px;
  font-weight: bold;
  border-radius: 6px;
  transition: 0.3s;
}
#totalcart button:hover {
  background-color: #e8325d;
  cursor: pointer;
}
a {
  text-decoration: none;
  font-size: 16px;
  color: white;
}
#totalcart input[type="submit"] {
  border: 0px;
  color: #ff3f6c;
  font-size: 16px;
  padding: 5px 10px;
  background-color: transparent;
  border-radius: 6px;
  font-weight: bold;
}
#totalcart input[type="submit"]:hover {
  cursor: pointer;
  background-color: #ff3f6c;
  color: white;
  transition: 0.3s;
}

/* ---------------- COUPON SECTION ---------------- */
#couponForm {
  margin-top: 10px;
  padding: 10px 0;
}
#couponForm label {
  font-size: 16px;
  color: #333;
  font-weight: 600;
}
#couponForm input[type="text"] {
  width: 90%;
  padding: 8px;
  margin-top: 5px;
  margin-bottom: 8px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 15px;
}
#couponForm input[type="text"]:focus {
  outline: none;
  border-color: #ff3f6c;
  box-shadow: 0 0 4px rgba(255, 63, 108, 0.4);
}
#couponButtons {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
}
.coupon-option {
  border: 1px solid #ff3f6c;
  background-color: white;
  color: #ff3f6c;
  padding: 6px 12px;
  border-radius: 8px;
  font-size: 14px;
  transition: 0.3s;
  cursor: pointer;
}
.coupon-option:hover {
  background-color: #ff3f6c;
  color: white;
  transform: scale(1.05);
}
#couponMessage {
  margin-top: 10px;
  font-size: 14px;
  color: green;
  font-weight: bold;
}
#removeCoupon {
  display: none;
  margin-top: 10px;
  background: #ff4d4d;
  color: white;
  border: none;
  padding: 6px;
  border-radius: 6px;
  font-size: 14px;
  cursor: pointer;
}
#removeCoupon:hover {
  background: #e8325d;
}

/* ---------------- GENERAL STYLING ---------------- */
hr {
  margin: 10px;
  color: #ccc;
}
button:hover,
input[type="submit"]:hover {
  cursor: pointer;
}
</style>
</head>
<body>

<!-- NAVBAR -->
<div id="navbar">
  <div id="left"><a href="#"><img src="https://i.postimg.cc/T2Lx6cQG/STYLE-UP-Photo-Room.png"></a></div>
  <div id="centre"><span><span>BAG</span> ------------- <a href="#">ADDRESS</a> ------------- <a href="#">PAYMENT</a></span></div>
  <div id="right"><div><img src="https://i.postimg.cc/NGSHspcx/sprite-secure.png"></div><div id="secure"><span>100% secure</span></div></div>
</div>

<!-- CART -->
<div id="cartdiv">
  <span id="product"></span>
  <div id="totalcart">
    <h2>PRICE DETAILS</h2>
    <span>Items :</span><span id="Noofitems"></span><br><hr>
    <span>Total MRP : ₹</span><span id="cart-value"></span><br><hr>
    <form id="couponForm">
      <label>Apply Coupon</label><br>
      <input type="text" id="coupan" placeholder="Enter Coupon Code">
      <input type="submit" value="Apply">
      <div id="couponButtons">
        <button type="button" class="coupon-option" data-code="SAVE10">SAVE10 – 10% Off</button>
        <button type="button" class="coupon-option" data-code="SAVE20">SAVE20 – 20% Off</button>
        <button type="button" class="coupon-option" data-code="FREESHIP">FREESHIP – ₹50 Off</button>
      </div>
      <button type="button" id="removeCoupon">Remove Coupon</button>
      <p id="couponMessage"></p>
    </form>
    <hr>
    <span>Total Amount : ₹</span><span id="Finalamount"></span><br>
    <button id="address"><a href="#">PLACE ORDER</a></button>
  </div>
</div>

<script>
// ---------------- JS Logic ----------------
let cartarr = JSON.parse(localStorage.getItem("cartData")) || [];
let appliedCoupon = localStorage.getItem("appliedCoupon") || null;

window.addEventListener("load", function(){
  displaycart(cartarr);
  update();
  if (appliedCoupon) {
    applyCoupon(appliedCoupon, true);
    document.querySelector("#removeCoupon").style.display = "block";
  }
});

function displaycart(cartarr){
  document.querySelector("#product").innerHTML = "";
  cartarr.forEach(function(el,index){
    let dives=document.createElement("div");
    dives.style.padding="5px";
    dives.style.backgroundColor="#fdefea";
    dives.style.marginBottom="10px";

    let divs=document.createElement("div");
    let image=document.createElement("img");
    image.setAttribute("src",el.image_url);
    image.style.height = "80px";

    let name=document.createElement("h3");
    name.innerText=el.name;

    let price=document.createElement("p");
    price.innerText="₹"+el.cartprice;

    let dile=document.createElement("span");
    dile.style.border="1px solid #ccc";
    dile.style.margin="0px";

    let decr=document.createElement("button");
    decr.innerText="-";
    decr.addEventListener("click",function(){ decrease(el,index,cartarr) });

    let quantity=document.createElement("span");
    quantity.innerText=el.quantity;

    let incr=document.createElement("button");
    incr.innerText="+";
    incr.addEventListener("click",function(){ increase(el,index,cartarr) });

    dile.append(decr,quantity,incr);

    let dele=document.createElement("button");
    dele.innerText="REMOVE";
    dele.addEventListener("click",function(){ removeitem(el,index,cartarr) });

    let quan=document.createElement("div");
    quan.style.marginLeft="10px";
    quan.append(name,price,dile,dele);
    divs.append(image,quan);
    dives.append(divs);
    document.querySelector("#product").append(dives);
  });
}

function decrease(el,i,arr){
  arr[i].quantity--;
  if(arr[i].quantity==0){
    arr.splice(i,1);
  }
  arr[i].cartprice=arr[i].quantity*el.price;
  localStorage.setItem("cartData",JSON.stringify(arr));
  window.location.reload();
}

function increase(el,i,arr){
  arr[i].quantity++;
  arr[i].cartprice=arr[i].quantity*el.price;
  localStorage.setItem("cartData",JSON.stringify(arr));
  window.location.reload();
}

function removeitem(el,i,arr){
  arr.splice(i,1);
  localStorage.setItem("cartData",JSON.stringify(arr));
  window.location.reload();
}

function update(){
  let items=0;
  let cartvalue=0;
  let cartarr1=JSON.parse(localStorage.getItem("cartData"))||[];
  for(let i=0;i<cartarr1.length;i++){
    items+=cartarr1[i].quantity;
    cartvalue+=cartarr1[i].cartprice;
  }
  document.querySelector("#Noofitems").innerText=items;
  document.querySelector("#cart-value").innerText=cartvalue;
  document.querySelector("#Finalamount").innerText=cartvalue;
}

const formtag = document.querySelector("#couponForm");
const message = document.querySelector("#couponMessage");

formtag.addEventListener("submit", function(event){
  event.preventDefault();
  let code = document.querySelector("#coupan").value.trim().toUpperCase();
  if (appliedCoupon && appliedCoupon !== code) {
    message.textContent = "⚠ A coupon is already applied. It will be replaced.";
  }
  applyCoupon(code);
  document.querySelector("#removeCoupon").style.display = "block";
});

document.querySelectorAll(".coupon-option").forEach(btn => {
  btn.addEventListener("click", function(){
    const code = this.getAttribute("data-code");
    if (appliedCoupon && appliedCoupon !== code) {
      message.textContent = "⚠ A coupon is already applied. It will be replaced.";
    }
    applyCoupon(code);
    document.querySelector("#removeCoupon").style.display = "block";
  });
});

document.querySelector("#removeCoupon").addEventListener("click", function(){
  appliedCoupon = null;
  localStorage.removeItem("appliedCoupon");
  localStorage.removeItem("discountedTotal");
  update();
  message.textContent = "❌ Coupon removed.";
  document.querySelector("#removeCoupon").style.display = "none";
});

function applyCoupon(coupon, auto=false){
  let cartvalue = (+document.querySelector("#cart-value").innerText);
  let discount = 0;

  if(coupon === "SAVE10"){
    discount = cartvalue * 0.10;
    message.textContent = "✅ 10% discount applied!";
  } else if(coupon === "SAVE20"){
    discount = cartvalue * 0.20;
    message.textContent = "✅ 20% discount applied!";
  } else if(coupon === "FREESHIP"){
    discount = 50;
    message.textContent = "✅ ₹50 off applied!";
  } else if(coupon === "MASAI30"){
    discount = cartvalue * 0.30;
    message.textContent = "✅ 30% discount applied!";
  } else {
    if (!auto) message.textContent = "❌ Invalid coupon code.";
    return;
  }

  const newTotal = (cartvalue - discount).toFixed(2);
  document.querySelector("#Finalamount").innerText = newTotal;

  appliedCoupon = coupon;
  localStorage.setItem("appliedCoupon", appliedCoupon);
  localStorage.setItem("discountedTotal", newTotal);

  if (!auto) message.textContent += ` New Total: ₹${newTotal}`;
}
</script>
</body>
</html>
